### 1. HTTP 메세지 헤더
HTTP 프로토콜의 리퀘스트와 리스폰스에는 반드시 메세지 헤더가 포함되어 있는데 메세지 헤더에는 클라이언트나 서버가 리퀘스트나 리스폰스를 처리하기 위한 정보가 들어있다.

#### 1-1 리퀘스트 메세지 헤더
<img src="https://images.velog.io/images/jaeeunxo1/post/e8d11649-7380-47bf-bcdb-1ddbcf15f8e1/image.png" width="400">

#### 1-2 리스폰스 메세지 헤더
<img src="https://images.velog.io/images/jaeeunxo1/post/44080b34-fc3c-4b0d-a6fe-d27fe1ca78b4/image.png" width="400">

### 2. HTTP/1.1 헤더 필드의 구조
HTTP 헤더 필드는 헤더 필드 명과 필드 값으로 구성되어있다.

`Content-Type:text/html` : Content-Type은 헤더 필드명이고 text/html은 값이다. 헤더 필드 값은 여러개 가능하다.
중복된 경우에는 브라우저에 따라 다르게 동작하며, 최초의 헤더 필드를 우선적으로 처리하고 어떤 브라우저는 마지막 헤더 필드를 우선적으로 처리한다.

`일반적 헤더 필드(General Header Fields)` : 리퀘스트와 리스폰스 메세지 둘다 사용되는 헤더

`리퀘스트 헤더 필드(Request Header Fields)` : 클라이언트 측에서 서버 측으로 송신된 리퀘스트 메세지에 사용되는 헤더로 리퀘스트의 부가적 정보와 클라이언트의 정보, 리스폰스의 컨텐츠에 관한 우선 순위 등을 부과

`리스폰스 헤더 필드(Response Header Fields)` : 서버 측에서 클라이언트 측으로 송신한 리스폰스 메세지에 사용되는 헤더로 리스폰스의 정보와 서버의 정보, 클라이언트의 추가 정보 요구 등을 부가한다.

`엔티티 헤더 필드(Entity Header Fields)` : 콘텐츠 갱신 시간 등의 엔티티에 관한 정보를 부가합니다.

### 3. HTTP/1.1 일반 헤더 필드

#### 3-1 Cache-Control (캐시 동작을 지정)
`pulbic` : 다른 유저에게도 돌려줄 수 있는 캐시를 해도 좋다는 것을 명시적으로 나타낸다.

`private` : 특정 유저만을 대상으로 하고 있다는 것을 나타낸다. 

`no-cache` : 캐시로부터 오래된 리소스가 반환되는 것을 막기 위해 사용된다. 중간 캐시 서버가 오리진 리퀘스트를 전송해야 한다.
리스폰스에 사용되면 리퀘스트에서 리소스의 유효성을 재확인 않고는 리스폰스를 사용하지 못한다.

`no-store` : 리스폰스와 리퀘스트에 기밀 정보가 포함되어 있음을 나타낸다. 그렇기 때문에 일부분을 로컬 스토리지에 보존 해서는 안되도록 지정한다.

`s-maxage` : `max-age` 와 동일하지만 여러 유저가 이용할 수 있는 공유 캐시 서버에만 적용된다는 것이다. 이 필드가 사용되는 경우 `max-age` 는 무시된다.

`max-age` : 지정되었던 값보다 새로운 경우네는 캐시되었던 리소스를 받아들 일 수 있다. 또한 지정한 값이 0이면 캐시 서버는 리퀘스트를 항상 오리진 서버에 넘길 필요가 있다. 

`min-fresh` : 캐시된 리소스가 적어도 지정된 시간은 최신 상태의 것을 반환하도록 캐시 서버에 요구한다. 60초로 지정되어 있는 경우에는 60초 이내에 유효 기간이 끝나는 리소스를 리스폰스로 반환하면 안된다.

`max-stale` : 캐시된 리소스의 유효 기간이 끝났더라도 받아들일 수 있음을 나타낸다. 값이 지정되어 있지 않는 경우는 클라이언트는 아무리 시간이 경과했더라도 리스폰스를 받아들인다. 값이 지정되어 있는 경우네는 유효 기한이 지난 후로부터 지정 시간 내라면 받아 들인다는 뜻이다.

`only-if-cached` : 클라이언트는 캐시 서버에 대해서 목적한 리소스가 로컬 캐시에 있는 경우만 리스폰스를 반환하도록 요구한다. 즉, 캐시 서버에서 리스폰스의 리로드와 유효성을 재확인하지 않도록 요구한다.

`must-reavalidation` : 리스폰스의 캐시가 현재도 유효한지 아닌지의 여부를 오리진 서버에 조회를 요구한다. 프록시가 오리진 서버에 도달할 수 없고 리소스를 다시 요구할 수 없는 경우에 캐시는 클라이언트에 504를 반환한다. 

`proxy-revalidation` : 모든 캐시 서버에 대해서 이후의 리퀘스트로 해당 리스폰스를 반환할 때는 반드시 유효성 재확인을 하도록 한다.

`no-transform` : 리퀘스트와 리스폰스의 어느 쪽에 있어서도 캐시가 엔티티 바디의 미디어 타입을 변경하지 않도록 지정한다. 캐시 서버등에 의해서 이미지가 압출되는 것을 방지한다.

`cache-extension 토큰` :  토큰을 이사용하여 디렉티브를 확장할 수 있다. 만약 이해할 수 있는 extension이면 의미가 있고, 이해하지 못하면 무시됩니다.

#### 3-2 Connection 

 `Connection : 더 이상 전송하지 않는 헤더 필드명` : 프록시에 더 이상 전송하지 않는 헤더 필드를 지정하고, 지속적 접속 관리한다. Upgrade 더이상 전송하지 않는다.

```
GET / HTTP/1.1
Upgrade : HTTP/1.1
Connection : Upgrade
```

 `Connection : close` : HTTP/1.1 지속적 접속이 디폴트로 되어있다. 서버 측에서 명시적으로 접속을 끊고 싶을 경우에는 필드에 적는다. 오래된 버전의 HTTP는 지속적 접속이 디폴트가 아니었다. 그래서 Keep-Alive 를 통해 지속적 접속을 지정한다.

#### 3-3 Trailer & Transfer-Encoding

`Trailer` : 메세지 바디의 뒤에 기술되어 있는 헤더 필드를 미리 전달할 수 있다. 청크 전송 인코딩을 사용하고 있는 경우에 사용 가능하다.

`Transfer-Encoding` : 청크 전송 코딩이 유효한 상황이고 몇 byte로 분할되어 있는 지 확인할 수 있다.

#### 3-4 Upgrade

다른 프로콜의 새로운 버전이 통신에 이용되는 경우에 사용된다. 지정하는 대상이 전혀 다른 통신 프로토콜이라고 하더라도 문제없다.

#### 3-5 Via

Via 헤더 필드는 클라이언트와 서버 간의 리퀘스트 혹은 리스폰스 메세지의 경로를 알기 위해서 사용한다. 프록시 혹은 게이트웨이는 자신의 서버 정보를 Via 헤더 필드에 추가한 뒤에 메세지를 전송한다. 전송된 메세지의 추적과 리퀘스트 루프의 회피 등에 사용되기 때문에 프록시를 경우하는 경우에 반드시 부가할 필요가 있다.

#### 3-6 Warning

리스폰스에 관한 추가 정보를 전달한다. 기본적으로 캐시에 관한 문제의 경고를 유저에게 전달한다. 

`Warning: 113 gw.hackr.jp:8080 "Heuristic expiration"Tue.03 Jul`  : [경고코드] [경고한 호스트:포트 번호]"[경고문]"([날짜]) 로 날짜는 생략될 수 있다. 여기에 정의되어 있는 코드에 대한 경고문은 어디까지나 권장 사항이다.  



#### 참고

https://flylib.com/books/en/4.253.1.155/1/